const movieQuestions = [
  {
    movie: "The Lion King",
    questions: [
      {
        question: "What is Simba's father's name?",
        answers: ["Scar", "Mufasa", "Timon", "Rafiki"],
        correct: 1
      },
      {
        question: "Who is the villain in The Lion King?",
        answers: ["Scar", "Mufasa", "Zazu", "Nala"],
        correct: 0
      },
      {
        question: "What is Simba's childhood best friend's name?",
        answers: ["Shenzi", "Sarabi", "Kiara", "Nala"],
        correct: 3
      },
      {
        question: "What are the names of the two animals who help Simba after he flees?",
        answers: ["Zazu and Scar", "Timon and Pumbaa", "Shenzi and Banzai", "Nala and Sarabi"],
        correct: 1
      },
      {
        question: "Which song do Timon and Pumbaa sing to cheer up Simba?",
        answers: ["Circle of Life", "Can You Feel the Love Tonight", "Hakuna Matata", "Be Prepared"],
        correct: 2
      },
      {
        question: "Who is Simba's mother?",
        answers: ["Nala", "Sarabi", "Kiara", "Shenzi"],
        correct: 1
      },
      {
        question: "What does Hakuna Matata mean?",
        answers: ["No fear", "No worries", "Be strong", "Anything is possible"],
        correct: 1
      },
      {
        question: "How does Mufasa die?",
        answers: ["He falls off a cliff", "He is killed by Simba", "He is killed by hyenas", "He dies of old age"],
        correct: 0
      },
      {
        question: "Who is the wise monkey in the movie?",
        answers: ["Timon", "Scar", "Zazu", "Rafiki"],
        correct: 3
      },
      {
        question: "What is the first song in the movie?",
        answers: ["Can You Feel the Love Tonight", "Hakuna Matata", "Circle of Life", "I Just Can't Wait to Be King"],
        correct: 2
      }
    ]
  },
  {
    movie: "Frozen",
    questions: [
      {
        question: "What is the name of the Ice Queen?",
        answers: ["Elsa", "Anna", "Kristoff", "Olaf"],
        correct: 0
      },
      {
        question: "What is Elsa's sister's name?",
        answers: ["Elsa", "Kristoff", "Anna", "Hans"],
        correct: 2
      },
      {
        question: "What animal accompanies Kristoff?",
        answers: ["A reindeer", "A moose", "A bear", "A wolf"],
        correct: 0
      },
      {
        question: "What is Olaf's favorite season?",
        answers: ["Winter", "Spring", "Summer", "Autumn"],
        correct: 2
      },
      {
        question: "What is the name of the castle where Elsa and Anna grew up?",
        answers: ["Corona", "Arendelle", "Atlantica", "Neverland"],
        correct: 1
      },
      {
        question: "Which song does Elsa sing as she leaves her home?",
        answers: ["For the First Time in Forever", "Do You Want to Build a Snowman", "In Summer", "Let It Go"],
        correct: 3
      },
      {
        question: "What happens when Elsa loses control of her powers?",
        answers: ["She freezes things", "She creates fire", "She loses her voice", "She can't cast magic anymore?"],
        correct: 0
      },
      {
        question: "Who tries to overthrow Elsa and take the throne?",
        answers: ["Kristoff", "Hans", "Olaf", "Sven"],
        correct: 1
      },
      {
        question: "Who is Elsa and Anna's best friend?",
        answers: ["Olaf", "Hans", "Kristoff", "Sven"],
        correct: 0
      },
      {
        question: "What Color is Elsa's dress during her Let It Go performance?",
        answers: ["Green", "Blue", "Red", "White"],
        correct: 1
      }
    ]
  },
  {
    movie: "Aladdin",
    questions: [
      {
        question: "Who is Aladdin's best friend?",
        answers: ["Abu", "Jafar", "Genie", "Rajah"],
        correct: 0
      },
      {
        question: "What is the name of the villain in the movie?",
        answers: ["Aladdin", "Jafar", "Abu", "Iago"],
        correct: 1
      },
      {
        question: "What is the name of the princess Aladdin loves?",
        answers: ["Elsa", "Belle", "Ariel", "Jasmine"],
        correct: 3
      },
      {
        question: "What magical object helps Aladdin?",
        answers: ["A crystal ball", "A wand", "A lamp", "A ring"],
        correct: 2
      },
      {
        question: "What kind of animal is Aladdin's companion Abu?",
        answers: ["A tiger", "A monkey", "A parrot", "A dog"],
        correct: 1
      },
      {
        question: "What is the name of Jafar's parrot?",
        answers: ["Abu", "Iago", "Rajah", "Zazu"],
        correct: 1
      },
      {
        question: "Which song do Aladdin and Jasmine sing together?",
        answers: ["Prince Ali", "Friend Like Me", "A Whole New World", "Arabian Nights"],
        correct: 2
      },
      {
        question: "In which city does Aladdin live?",
        answers: ["Arendelle", "Agrabah", "Corona", "Atlantica"],
        correct: 1
      },
      {
        question: "What is Aladdin's first wish from the Genie?",
        answers: ["A castle", "Wealth", "To become a prince", "Immortality"],
        correct: 2
      },
      {
        question: "How is Jafar defeated at the end?",
        answers: ["He becomes a genie", "He is banished", "He becomes king", "He is trapped in a lamp"],
        correct: 3
      }
    ]
  },
  {
    movie: "Beauty and the Beast",
    questions: [
      {
        question: "What is the first song Belle sings in the movie?",
        answers: ["Gaston", "Be Our Guest", "Belle", "Something There"],
        correct: 2
      },
      {
        question: "Which room in the castle is Belle forbidden from entering",
        answers: ["The kitchen", "The west wing", "The library", "The ballroom"],
        correct: 1
      },
      {
        question: "What does Belle give her father before he leaves?",
        answers: ["A kiss", "A clock", "A book", "A scarf"],
        correct: 3
      },
      {
        question: "Who is the first enchanted object Belle meets in the castle?",
        answers: ["LumiÃ¨re", "Mrs. Potts", "Cogsworth", "Chip"],
        correct: 3
      },
      {
        question: "What does Gaston want from Belle?",
        answers: ["Her help with hunting", "Her hand in marriage", "A book", "Her friendship"],
        correct: 1
      },
      {
        question: "How many brothers does Gaston have?",
        answers: ["Two", "None", "Three", "One"],
        correct: 1
      },
      {
        question: "What is the last song sung in the movie?",
        answers: ["Belle", "Be Our Guest", "Beauty and the Beast", "The Mob Song"],
        correct: 2
      },
      {
        question: "What is Belle's favorite book?",
        answers: ["An adventure book", "A farytaile book", "A history book", "A cookbook"],
        correct: 1
      },
      {
        question: "What is the name of Belle's horse?",
        answers: ["Philippe", "Maximus", "Pegasus", "Achilles"],
        correct: 0
      },
      {
        question: "What happens to the Beast when the last petal of the rose falls?",
        answers: ["He becomes a prince", "He remains a beast forever", "He dies", "He becomes invisible"],
        correct: 1
      }
    ]
  },
  {
    movie: "Tangled",
    questions: [
      {
        question: "How long is Rapunzel's hair?",
        answers: ["20 meters", "30 meters", "40 meters", "50 meters"],
        correct: 1
      },
      {
        question: "What is the name of the kingdom where Rapunzel lives?",
        answers: ["Arendelle", "Corona", "Agrabah", "Atlantica"],
        correct: 1
      },
      {
        question: "What is Rapunzel's chameleon Pascal's favorite food?",
        answers: ["Apples", "Carrots", "Bread", "Insects"],
        correct: 3
      },
      {
        question: "How many laterns are released on Rapunzel's birthday?",
        answers: ["10,000", "1,000", "5,000", "2,000"],
        correct: 0
      },
      {
        question: "What is Flynn Rider's real name?",
        answers: ["Eugene Fritzherbert", "Eric Smith", "Philip Anderson", "Maximus Johnson"],
        correct: 0
      },
      {
        question: "What does Rapunzel want to see the most?",
        answers: ["The sea", "The laterns", "The city", "The mountains"],
        correct: 1
      },
      {
        question: "What color is Rapunzel's dress at the end of the movie",
        answers: ["Blue", "Green", "Purple", "Yellow"],
        correct: 2
      },
      {
        question: "What is the name of the horse chasing Flynn?",
        answers: ["Achilles", "Philippe", "Maximus", "Pegasus"],
        correct: 2
      },
      {
        question: "What is Rapunzels secret ability?",
        answers: ["Flying", "Talking to animals", "Healing hair", "Invisibility"],
        correct: 2
      },
      {
        question: "Where is Rapunzel imprisoned by mother Gothe",
        answers: ["In a castle", "In a cave", "In a forest house", "In a tower"],
        correct: 3
      }
    ]
  },
];

const questions = movieQuestions.map(movie => movie.questions).flat()
console.log(questions)

// Get the number of questions from the URL
let numQuestions = getQueryParam('questions');
const movieParam = getQueryParam('movie')
console.log(movieParam)
let movie =""
switch (movieParam) {
  case 'the-lion-king': movie = "The Lion King"; break;
  case 'aladdin': movie = "Aladdin"; break; 
  case 'frozen': movie = "Frozen"; break; 
  case 'beauty-beast': movie = "Beauty and the Beast"; break; 
  case 'tangled': movie = "Tangled"; break; 
  default: movie="";
}
console.log(movie)


// Display the selected number of questions or default to 10 if not set
if (numQuestions) {
  numQuestions = Number(numQuestions)
  console.log(`Number of questions selected: ${numQuestions}`);
  // Use `numQuestions` to load the appropriate number of questions
} else {
  console.log("No parameter found, defaulting to 10 questions.");
  numQuestions = 10
}
console.log(numQuestions);
const selectedQuestions = selectRandomQuestions(numQuestions + 1);
console.log(selectedQuestions); // Display selected questions in the console
// });

// Function: select random questions
function selectRandomQuestions(numberOfQuestions) {
  const selectedQuestions = [];
  let copyQuestions = []
  if (!movie){
    copyQuestions = [...questions]; // Create a copy of the array
  } else {
    console.log(movie)
    movieQuestions.forEach(obj => {
      console.log(obj)
      console.log("movie", obj.movie)
      if(obj.movie === movie) copyQuestions =  obj.questions
    })
  }
  console.log(copyQuestions)
  for (let i = 0; i < numberOfQuestions; i++) {
    const randomIndex = Math.floor(Math.random() * copyQuestions.length);
    selectedQuestions.push(copyQuestions[randomIndex]);
    copyQuestions.splice(randomIndex, 1); // Remove the selected question
  }

  return selectedQuestions;
}

function getQueryParam(param) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(param);
}



//function: display questions and generate and display buttons with answers
let currentQuestion = 0;
let correctQuestions = 0;
const questionEl = document.getElementById("question");
const answersEl = document.getElementById("answers");

function showQuestion(index) {
  console.log(index)
  const q = selectedQuestions[index];
  questionEl.textContent = q.question;
  answersEl.innerHTML = "";

  q.answers.forEach((answer, i) => {
    const button = document.createElement("button");
    button.textContent = answer;
    button.onclick = () => handleAnswer(i, q.correct, button);
    answersEl.appendChild(button);
  });
}

function handleAnswer(selected, correct, button) {
  if (selected === correct) {
    button.classList.add("correct");
    correctQuestions++;
    console.log("# correct questions: ", correctQuestions)
  } else {
    button.classList.add("wrong");
  }

  setTimeout(() => {
    currentQuestion = (currentQuestion + 1) % selectedQuestions.length;
    console.log(currentQuestion, numQuestions);
    showQuestion(currentQuestion);
  }, 1000);
  if (currentQuestion === numQuestions -1) {
    window.location.href = `closingPage.html?correct=${correctQuestions}`
  }
}

function updateClock() {
  const clockEl = document.getElementById("clock");
  const now = new Date();
  const time = now.toLocaleTimeString("de-DE", { hour: "2-digit", minute: "2-digit", second: "2-digit" });
  clockEl.textContent = time;
}

setInterval(updateClock, 1000);
updateClock(); 
showQuestion(currentQuestion);